C51 COMPILER V9.59.0.0   MAIN                                                              07/28/2019 12:43:51 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN MAIN.OBJ
COMPILER INVOKED BY: D:\program\keil_v5\C51\BIN\C51.EXE MAIN.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include<reg52.h>
   2          #include<main.h>
   3          #include<mfrc522.h>
   4          
   5          unsigned char UID[5],Temp[4];
   6          
   7          void feeb(){ //寻卡成功响应函数
   8   1        ff=0;
   9   1        delay_10ms(1);
  10   1        ff=1;
  11   1        delay_10ms(1);
  12   1      }
  13          
  14          void Auto_Reader(void){
  15   1        while(1){
  16   2          if(PcdRequest(0x52,Temp)==MI_OK){  //寻卡，成功后Temp数组为卡类型
  17   3            if(PcdAnticoll(UID)==MI_OK){    //防冲突，UID数组数据为卡序列号
  18   4                 CALL_isr_UART();       //开串口中断将UID数组前四个字节上传到串口调试助手
  19   4             feeb();                    //调用蜂鸣器提示           
  20   4            }
  21   3          }else ff = 0;//寻卡失败
  22   2        } 
  23   1      }
  24          
  25          void InitializeSystem(){
  26   1        SCON=0X50;      //设置为工作方式1
  27   1        TMOD=0X21;      //设置计数器工作方式2
  28   1        PCON=0X80;      //波特率加倍
  29   1        TH1=0XF3;       //计数器初始值设置，注意波特率是4800的
  30   1        TL1=0XF3;
  31   1        REN = 1;
  32   1        ES=1;           //打开接收中断
  33   1        EA=1;           //打开总中断
  34   1        TR1=1;    
  35   1        ff = 0;
  36   1          PcdReset();
  37   1          PcdAntennaOff(); 
  38   1          PcdAntennaOn();  
  39   1        M500PcdConfigISOType( 'A' );
  40   1      }
  41          
  42          void isr_UART(void) interrupt 4 using 1{
  43   1          unsigned char i;
  44   1        if(TI){
  45   2          TI=0;
  46   2          for(i=0;i<4;i++){
  47   3            SBUF=UID[i];
  48   3            while(!TI);
  49   3            TI=0;     
  50   3          }
  51   2          REN=1;
  52   2        }
  53   1      }
  54          
  55          void main( ){   
C51 COMPILER V9.59.0.0   MAIN                                                              07/28/2019 12:43:51 PAGE 2   

  56   1          InitializeSystem( );
  57   1        Auto_Reader();
  58   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    153    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      9    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
